<ng-container *ngIf="task$ | ngrxPush as task">
  <mat-toolbar>
    <a routerLink="./.." mat-icon-button>
      <mat-icon>arrow_back</mat-icon>
    </a>
    <h2>
      <mat-icon class="fix-icon-color">{{ task | taskStateIcon }}</mat-icon
      >{{ task.name }}
    </h2>
    <button-task-actions [task]="task"></button-task-actions>
  </mat-toolbar>
  <ng-scrollbar>
    <table mat-table [dataSource]="sortedSessions$">
      <ng-container matColumnDef="start">
        <th mat-header-cell *matHeaderCellDef>Start</th>
        <td mat-cell *matCellDef="let session">{{ session.start | date: 'yyyy-MM-dd H:mm' }}</td>
        <td mat-footer-cell *matFooterCellDef>Total</td>
      </ng-container>
      <ng-container matColumnDef="end">
        <th mat-header-cell *matHeaderCellDef>End</th>
        <td mat-cell *matCellDef="let session">{{ session.end | date: 'yyyy-MM-dd H:mm' }}</td>
        <td mat-footer-cell *matFooterCellDef></td>
      </ng-container>
      <ng-container matColumnDef="duration">
        <th mat-header-cell *matHeaderCellDef>Duration</th>
        <td
          mat-cell
          *matCellDef="let session"
          [matTooltip]="((session | sessionDuration | ngrxPush) || 0) / 1000 | toString"
        >
          {{ session | sessionDuration | formatDuration | ngrxPush }}
        </td>
        <td mat-footer-cell *matFooterCellDef [matTooltip]="task | taskDuration | ngrxPush | toString">
          {{ task | taskDuration | formatDuration | ngrxPush }}
        </td>
      </ng-container>
      <ng-container matColumnDef="action">
        <th mat-header-cell *matHeaderCellDef style="width: 40px"></th>
        <td mat-cell *matCellDef="let session" class="cell-action">
          <button-session-actions [session]="session" [task]="task"></button-session-actions>
        </td>
        <td mat-footer-cell *matFooterCellDef></td>
      </ng-container>
      <tr mat-header-row *matHeaderRowDef="displayedColumns; sticky: true"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
      <tr mat-footer-row *matFooterRowDef="displayedColumns; sticky: true"></tr>
    </table>
  </ng-scrollbar>
  <button
    (click)="start(task.id)"
    *ngIf="(taskIsInProgress$ | ngrxPush) === false"
    mat-fab
    color="accent"
    matTooltip="Start"
  >
    <mat-icon>play_arrow</mat-icon>
  </button>
  <button
    (click)="stop(task.id)"
    *ngIf="(taskIsInProgress$ | ngrxPush) === true"
    mat-fab
    color="primary"
    matTooltip="Stop"
  >
    <mat-icon>pause</mat-icon>
  </button>
</ng-container>
