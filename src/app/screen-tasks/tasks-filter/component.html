<form class="mat-body" (submit)="$event.preventDefault()" [formGroup]="form" filterForm>
  <mat-form-field class="name">
    <mat-label>Name</mat-label>
    <input
      type="search"
      matInput
      placeholder="Search"
      name="search"
      formControlName="search"
      #searchInput
      cdkFocusRegionStart
      cdkFocusInitial
    />
    <button-reset-input-control matSuffix [control]="form.controls.search"></button-reset-input-control>
  </mat-form-field>
  <mat-form-field>
    <input matInput [ngxMatDatetimePicker]="from" placeholder="From" formControlName="from" />
    <button-reset-input-control matSuffix [control]="form.controls.from"></button-reset-input-control>
    <mat-datepicker-toggle matSuffix [for]="$any(from)"></mat-datepicker-toggle>
    <ngx-mat-datetime-picker #from [showSeconds]="true"> </ngx-mat-datetime-picker>
  </mat-form-field>
  <mat-form-field>
    <input matInput [ngxMatDatetimePicker]="to" placeholder="To" formControlName="to" cdkFocusRegionEnd />
    <button-reset-input-control matSuffix [control]="form.controls.to"></button-reset-input-control>
    <mat-datepicker-toggle matSuffix [for]="$any(to)"></mat-datepicker-toggle>
    <ngx-mat-datetime-picker #to [showSeconds]="true"> </ngx-mat-datetime-picker>
  </mat-form-field>
  <button class="dates-menu" mat-icon-button matSuffix [matMenuTriggerFor]="fromMenu">
    <mat-icon>expand_more</mat-icon>
  </button>
</form>
<mat-menu #fromMenu="matMenu">
  <button mat-menu-item (click)="setAnyTime()">Any time</button>
  <button mat-menu-item (click)="setToday()">Today</button>
  <button mat-menu-item (click)="setYesterday()">Yesterday</button>
  <button mat-menu-item (click)="setThisWeek()">This week</button>
</mat-menu>
<ng-container *ngIf="timelineUplot$|async as data; else ghost">
  <ng-container *ngIf="chartRange$|async as range; else ghost">
    <timeline-chart-uplot
      *ngIf="data | map : hasChartData; else ghost"
      [@inOutAnimation]
      [chartData]="$any(data)"
      barWidth="day"
      [range]="range"
      (rangeChange)="onChartRangeChange($event)"
    ></timeline-chart-uplot>
  </ng-container>
</ng-container>
<ng-template #ghost>
  <timeline-chart-uplot [chartData]="[[],[]]" barWidth="day"></timeline-chart-uplot>
</ng-template>
